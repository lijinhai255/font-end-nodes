<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>koa(下一代web框架) | 前端总结</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="大前端课程电子书">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/font-end-nodes/assets/css/0.styles.038bd01d.css" as="style"><link rel="preload" href="/font-end-nodes/assets/js/app.832bd39e.js" as="script"><link rel="preload" href="/font-end-nodes/assets/js/2.a07749b4.js" as="script"><link rel="preload" href="/font-end-nodes/assets/js/1.80701c87.js" as="script"><link rel="preload" href="/font-end-nodes/assets/js/51.48a95f65.js" as="script"><link rel="prefetch" href="/font-end-nodes/assets/js/10.5638679e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/100.bbb244c0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/101.9bcb852f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/102.8dbea368.js"><link rel="prefetch" href="/font-end-nodes/assets/js/103.092e8ed9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/104.f4591300.js"><link rel="prefetch" href="/font-end-nodes/assets/js/105.fc42a7e9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/106.24d25138.js"><link rel="prefetch" href="/font-end-nodes/assets/js/107.f1e82fff.js"><link rel="prefetch" href="/font-end-nodes/assets/js/108.5bf31ec8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/109.6b14a562.js"><link rel="prefetch" href="/font-end-nodes/assets/js/11.a98b3d1b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/110.ca51e272.js"><link rel="prefetch" href="/font-end-nodes/assets/js/111.8036b121.js"><link rel="prefetch" href="/font-end-nodes/assets/js/112.8f521968.js"><link rel="prefetch" href="/font-end-nodes/assets/js/113.1aaf7230.js"><link rel="prefetch" href="/font-end-nodes/assets/js/114.8a58b5f0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/115.4a4b0a5a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/116.e2c0fc24.js"><link rel="prefetch" href="/font-end-nodes/assets/js/117.7f08754c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/118.53a69f97.js"><link rel="prefetch" href="/font-end-nodes/assets/js/119.32039f41.js"><link rel="prefetch" href="/font-end-nodes/assets/js/12.f77a1598.js"><link rel="prefetch" href="/font-end-nodes/assets/js/120.fe9d4157.js"><link rel="prefetch" href="/font-end-nodes/assets/js/121.5059caa6.js"><link rel="prefetch" href="/font-end-nodes/assets/js/122.93e4f4e0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/123.0427d914.js"><link rel="prefetch" href="/font-end-nodes/assets/js/124.fb5db03b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/125.eff72124.js"><link rel="prefetch" href="/font-end-nodes/assets/js/126.5071d677.js"><link rel="prefetch" href="/font-end-nodes/assets/js/127.b3c4b7ca.js"><link rel="prefetch" href="/font-end-nodes/assets/js/128.2ef02a49.js"><link rel="prefetch" href="/font-end-nodes/assets/js/129.3310c25b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/13.28e817ab.js"><link rel="prefetch" href="/font-end-nodes/assets/js/130.dd442d73.js"><link rel="prefetch" href="/font-end-nodes/assets/js/131.02f4f1ed.js"><link rel="prefetch" href="/font-end-nodes/assets/js/132.75abe376.js"><link rel="prefetch" href="/font-end-nodes/assets/js/133.b4cd450b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/134.773213fa.js"><link rel="prefetch" href="/font-end-nodes/assets/js/135.05acfff1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/136.561a96e3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/137.fc29b321.js"><link rel="prefetch" href="/font-end-nodes/assets/js/138.6a94f8cc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/139.8e167778.js"><link rel="prefetch" href="/font-end-nodes/assets/js/14.24b2d1e9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/140.a54c24f6.js"><link rel="prefetch" href="/font-end-nodes/assets/js/141.194fcb5f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/142.3274c5e9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/143.ec0a823c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/144.3ea73463.js"><link rel="prefetch" href="/font-end-nodes/assets/js/145.bb844e22.js"><link rel="prefetch" href="/font-end-nodes/assets/js/146.7da8e190.js"><link rel="prefetch" href="/font-end-nodes/assets/js/147.b412d59a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/148.cd0ec593.js"><link rel="prefetch" href="/font-end-nodes/assets/js/149.1f758e6c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/15.b5a6e3a7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/150.6e84f5f3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/151.a34b1a26.js"><link rel="prefetch" href="/font-end-nodes/assets/js/152.db2842b1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/153.f6a16ff9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/154.62fd3be8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/155.fd3625d1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/156.898c1c8b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/157.ccffe0db.js"><link rel="prefetch" href="/font-end-nodes/assets/js/158.7baa1f54.js"><link rel="prefetch" href="/font-end-nodes/assets/js/159.e751bb95.js"><link rel="prefetch" href="/font-end-nodes/assets/js/16.a6d304c0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/160.8a5bab47.js"><link rel="prefetch" href="/font-end-nodes/assets/js/161.db66d218.js"><link rel="prefetch" href="/font-end-nodes/assets/js/162.0299c78c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/163.81d4d2cd.js"><link rel="prefetch" href="/font-end-nodes/assets/js/164.edab15cc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/165.06fb1c70.js"><link rel="prefetch" href="/font-end-nodes/assets/js/166.003fb882.js"><link rel="prefetch" href="/font-end-nodes/assets/js/167.fae77e3f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/168.7c5a932e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/169.42c12bb0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/17.bc3513cf.js"><link rel="prefetch" href="/font-end-nodes/assets/js/170.80bdfb2e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/171.0cd4762d.js"><link rel="prefetch" href="/font-end-nodes/assets/js/172.e9c9c9ff.js"><link rel="prefetch" href="/font-end-nodes/assets/js/173.55b6a562.js"><link rel="prefetch" href="/font-end-nodes/assets/js/174.332f7641.js"><link rel="prefetch" href="/font-end-nodes/assets/js/175.ac667b47.js"><link rel="prefetch" href="/font-end-nodes/assets/js/176.9c953fb8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/177.09cb3caa.js"><link rel="prefetch" href="/font-end-nodes/assets/js/178.3b16f68c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/179.b68e7c4a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/18.9ffcf5fe.js"><link rel="prefetch" href="/font-end-nodes/assets/js/180.8c7ba5fc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/181.918fb497.js"><link rel="prefetch" href="/font-end-nodes/assets/js/182.55c29c82.js"><link rel="prefetch" href="/font-end-nodes/assets/js/183.d17aba41.js"><link rel="prefetch" href="/font-end-nodes/assets/js/184.2ef0b515.js"><link rel="prefetch" href="/font-end-nodes/assets/js/185.cb70f352.js"><link rel="prefetch" href="/font-end-nodes/assets/js/186.db8f35ad.js"><link rel="prefetch" href="/font-end-nodes/assets/js/187.01cad883.js"><link rel="prefetch" href="/font-end-nodes/assets/js/188.bbc4b58b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/189.a725e800.js"><link rel="prefetch" href="/font-end-nodes/assets/js/19.3bb95980.js"><link rel="prefetch" href="/font-end-nodes/assets/js/190.57b6c7af.js"><link rel="prefetch" href="/font-end-nodes/assets/js/191.5317b26c.js"><link rel="prefetch" href="/font-end-nodes/assets/js/192.1957e20b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/193.1f8a87e4.js"><link rel="prefetch" href="/font-end-nodes/assets/js/194.709ef4a8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/195.89d53a46.js"><link rel="prefetch" href="/font-end-nodes/assets/js/196.deb26b2a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/197.91768f16.js"><link rel="prefetch" href="/font-end-nodes/assets/js/198.262d7de3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/199.c72a561f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/20.b48aca0a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/200.70ae2a60.js"><link rel="prefetch" href="/font-end-nodes/assets/js/201.1c603d87.js"><link rel="prefetch" href="/font-end-nodes/assets/js/202.236c927e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/203.b521acdf.js"><link rel="prefetch" href="/font-end-nodes/assets/js/204.ea7aa51f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/205.30a1c9f5.js"><link rel="prefetch" href="/font-end-nodes/assets/js/206.06ae9af3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/207.1c669711.js"><link rel="prefetch" href="/font-end-nodes/assets/js/208.74d55e9a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/209.20a64f5d.js"><link rel="prefetch" href="/font-end-nodes/assets/js/21.43407cf9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/210.8123de01.js"><link rel="prefetch" href="/font-end-nodes/assets/js/211.b66cbd60.js"><link rel="prefetch" href="/font-end-nodes/assets/js/212.c679bf00.js"><link rel="prefetch" href="/font-end-nodes/assets/js/213.a74b7820.js"><link rel="prefetch" href="/font-end-nodes/assets/js/214.828ea554.js"><link rel="prefetch" href="/font-end-nodes/assets/js/215.7786d3de.js"><link rel="prefetch" href="/font-end-nodes/assets/js/216.51c1c323.js"><link rel="prefetch" href="/font-end-nodes/assets/js/217.65f8b41e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/218.c9df38de.js"><link rel="prefetch" href="/font-end-nodes/assets/js/219.b351dd6e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/22.19dadf3b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/220.39ab9705.js"><link rel="prefetch" href="/font-end-nodes/assets/js/221.8ebbb74a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/222.e2deb206.js"><link rel="prefetch" href="/font-end-nodes/assets/js/223.e2fcb32b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/224.ffaedba7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/225.b58f86d9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/226.399be9a7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/227.b51cf204.js"><link rel="prefetch" href="/font-end-nodes/assets/js/228.5009fc56.js"><link rel="prefetch" href="/font-end-nodes/assets/js/229.de5b340a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/23.d3c67335.js"><link rel="prefetch" href="/font-end-nodes/assets/js/230.98d2e2f2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/231.4fcae33b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/232.24744b96.js"><link rel="prefetch" href="/font-end-nodes/assets/js/233.0b4d75ba.js"><link rel="prefetch" href="/font-end-nodes/assets/js/234.888f6bf1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/235.21961b6f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/236.0f0c8301.js"><link rel="prefetch" href="/font-end-nodes/assets/js/237.7a097607.js"><link rel="prefetch" href="/font-end-nodes/assets/js/238.d8198c48.js"><link rel="prefetch" href="/font-end-nodes/assets/js/239.f19c451d.js"><link rel="prefetch" href="/font-end-nodes/assets/js/24.4f542f6f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/240.1ca90350.js"><link rel="prefetch" href="/font-end-nodes/assets/js/241.0bf3cab7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/242.e498cedc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/243.03b956d7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/244.558b6e6b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/245.5d6f4ee0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/246.b260c5c2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/247.beb18cd0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/248.719ed8b8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/249.1d0b4bf4.js"><link rel="prefetch" href="/font-end-nodes/assets/js/25.413ebcc0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/250.323c5592.js"><link rel="prefetch" href="/font-end-nodes/assets/js/251.5afad404.js"><link rel="prefetch" href="/font-end-nodes/assets/js/252.55fed331.js"><link rel="prefetch" href="/font-end-nodes/assets/js/253.827806ad.js"><link rel="prefetch" href="/font-end-nodes/assets/js/254.a88e257f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/255.ad4d0c32.js"><link rel="prefetch" href="/font-end-nodes/assets/js/26.2ef11f46.js"><link rel="prefetch" href="/font-end-nodes/assets/js/27.1ac063f4.js"><link rel="prefetch" href="/font-end-nodes/assets/js/28.0176bc33.js"><link rel="prefetch" href="/font-end-nodes/assets/js/29.f051ed2a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/3.3438f0f2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/30.14ff7587.js"><link rel="prefetch" href="/font-end-nodes/assets/js/31.2e4c2658.js"><link rel="prefetch" href="/font-end-nodes/assets/js/32.7bcd76e7.js"><link rel="prefetch" href="/font-end-nodes/assets/js/33.b5ea4703.js"><link rel="prefetch" href="/font-end-nodes/assets/js/34.4a59e1b2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/35.9ed9d4ab.js"><link rel="prefetch" href="/font-end-nodes/assets/js/36.682e318e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/37.7494daaa.js"><link rel="prefetch" href="/font-end-nodes/assets/js/38.b5cd0d3b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/39.af0496cd.js"><link rel="prefetch" href="/font-end-nodes/assets/js/4.7a5e1a1f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/40.14476c01.js"><link rel="prefetch" href="/font-end-nodes/assets/js/41.8bc5761f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/42.7aa4d4c4.js"><link rel="prefetch" href="/font-end-nodes/assets/js/43.62e2cdce.js"><link rel="prefetch" href="/font-end-nodes/assets/js/44.a1c3cc89.js"><link rel="prefetch" href="/font-end-nodes/assets/js/45.4fe7d8fb.js"><link rel="prefetch" href="/font-end-nodes/assets/js/46.6ab93663.js"><link rel="prefetch" href="/font-end-nodes/assets/js/47.a9584d0e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/48.4d783f78.js"><link rel="prefetch" href="/font-end-nodes/assets/js/49.08e03685.js"><link rel="prefetch" href="/font-end-nodes/assets/js/5.9263c847.js"><link rel="prefetch" href="/font-end-nodes/assets/js/50.236470a2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/52.aefd198b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/53.10124fe3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/54.7f193a2a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/55.8b6083af.js"><link rel="prefetch" href="/font-end-nodes/assets/js/56.c4735383.js"><link rel="prefetch" href="/font-end-nodes/assets/js/57.bcce1b46.js"><link rel="prefetch" href="/font-end-nodes/assets/js/58.d706164d.js"><link rel="prefetch" href="/font-end-nodes/assets/js/59.3d4b6637.js"><link rel="prefetch" href="/font-end-nodes/assets/js/6.1087f0eb.js"><link rel="prefetch" href="/font-end-nodes/assets/js/60.eaeb39ae.js"><link rel="prefetch" href="/font-end-nodes/assets/js/61.d29c232a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/62.0d9b1632.js"><link rel="prefetch" href="/font-end-nodes/assets/js/63.b7b031f3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/64.327ec6ab.js"><link rel="prefetch" href="/font-end-nodes/assets/js/65.7260dd4f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/66.89326128.js"><link rel="prefetch" href="/font-end-nodes/assets/js/67.c6db4c2f.js"><link rel="prefetch" href="/font-end-nodes/assets/js/68.c57a211e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/69.a18c29e4.js"><link rel="prefetch" href="/font-end-nodes/assets/js/7.072b61fc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/70.830c1fb2.js"><link rel="prefetch" href="/font-end-nodes/assets/js/71.8b0a8d85.js"><link rel="prefetch" href="/font-end-nodes/assets/js/72.cfe385d0.js"><link rel="prefetch" href="/font-end-nodes/assets/js/73.1f040d65.js"><link rel="prefetch" href="/font-end-nodes/assets/js/74.abc17026.js"><link rel="prefetch" href="/font-end-nodes/assets/js/75.48d766fe.js"><link rel="prefetch" href="/font-end-nodes/assets/js/76.309c6949.js"><link rel="prefetch" href="/font-end-nodes/assets/js/77.72d9f7a8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/78.ff5bc9e8.js"><link rel="prefetch" href="/font-end-nodes/assets/js/79.59c5403e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/80.1d2f49d1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/81.c479157a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/82.2a333eee.js"><link rel="prefetch" href="/font-end-nodes/assets/js/83.3a7be879.js"><link rel="prefetch" href="/font-end-nodes/assets/js/84.6d0d2b22.js"><link rel="prefetch" href="/font-end-nodes/assets/js/85.7e519f88.js"><link rel="prefetch" href="/font-end-nodes/assets/js/86.b82ff84b.js"><link rel="prefetch" href="/font-end-nodes/assets/js/87.9287a7fb.js"><link rel="prefetch" href="/font-end-nodes/assets/js/88.dea748dd.js"><link rel="prefetch" href="/font-end-nodes/assets/js/89.496fa253.js"><link rel="prefetch" href="/font-end-nodes/assets/js/90.07bc942e.js"><link rel="prefetch" href="/font-end-nodes/assets/js/91.03e65ea9.js"><link rel="prefetch" href="/font-end-nodes/assets/js/92.c58a7599.js"><link rel="prefetch" href="/font-end-nodes/assets/js/93.67e7d7f3.js"><link rel="prefetch" href="/font-end-nodes/assets/js/94.4a225295.js"><link rel="prefetch" href="/font-end-nodes/assets/js/95.a2616bcc.js"><link rel="prefetch" href="/font-end-nodes/assets/js/96.539d9eff.js"><link rel="prefetch" href="/font-end-nodes/assets/js/97.601ed07a.js"><link rel="prefetch" href="/font-end-nodes/assets/js/98.f4239bf1.js"><link rel="prefetch" href="/font-end-nodes/assets/js/99.c3c3e670.js"><link rel="prefetch" href="/font-end-nodes/assets/js/vendors~docsearch.6cf52aa5.js">
    <link rel="stylesheet" href="/font-end-nodes/assets/css/0.styles.038bd01d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/font-end-nodes/" class="home-link router-link-active"><!----> <span class="site-name">前端总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>harmonyOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/harmonyOS/" class="sidebar-link">HarmonyOS</a></li><li><a href="/font-end-nodes/basic/harmonyOS/02-应用程序基础框架.html" class="sidebar-link">应用框架基础知识</a></li><li><a href="/font-end-nodes/basic/harmonyOS/arkts.html" class="sidebar-link">ArkTS基础语法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/webpack/" class="sidebar-link">Webpack导学</a></li><li><a href="/font-end-nodes/basic/webpack/01-核心概念.html" class="sidebar-link">核心概念</a></li><li><a href="/font-end-nodes/basic/webpack/02-常见配置.html" class="sidebar-link">常见配置</a></li><li><a href="/font-end-nodes/basic/webpack/03-完整配置.html" class="sidebar-link">完整的配置</a></li><li><a href="/font-end-nodes/basic/webpack/04-ES6语法支持.html" class="sidebar-link">Babel核心知识</a></li><li><a href="/font-end-nodes/basic/webpack/05-webpack模块化.html" class="sidebar-link">模块化</a></li><li><a href="/font-end-nodes/basic/webpack/06-TS&amp;JS处理.html" class="sidebar-link">TS&amp;JS处理</a></li><li><a href="/font-end-nodes/basic/webpack/07-CSS处理.html" class="sidebar-link">CSS处理</a></li><li><a href="/font-end-nodes/basic/webpack/08-HTML.html" class="sidebar-link">HTML处理</a></li><li><a href="/font-end-nodes/basic/webpack/09-图片资源.html" class="sidebar-link">图片资源处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/jscriptText/" class="sidebar-link">概念</a></li><li><a href="/font-end-nodes/basic/jscriptText/01-环境配置.html" class="sidebar-link">环境配置</a></li><li><a href="/font-end-nodes/basic/jscriptText/02-基础语法.html" class="sidebar-link">基础用法</a></li><li><a href="/font-end-nodes/basic/jscriptText/03.工具函数.html" class="sidebar-link">工具函数</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ECMAScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/esText/" class="sidebar-link">内容介绍</a></li><li><a href="/font-end-nodes/basic/esText/01-ES2015.html" class="sidebar-link">ES2015</a></li><li><a href="/font-end-nodes/basic/esText/02-ES2016.html" class="sidebar-link">ES2016</a></li><li><a href="/font-end-nodes/basic/esText/03-ES5.html" class="sidebar-link">ES5</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/node/" aria-current="page" class="sidebar-link">内容介绍</a></li><li><a href="/font-end-nodes/basic/node/01-koa.html" aria-current="page" class="active sidebar-link">koa(下一代web框架)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#核心概念" class="sidebar-link">核心概念</a></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#初识-koa" class="sidebar-link">初识 koa</a></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#路由-中间件" class="sidebar-link">路由&amp;中间件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#安装依赖-koa-router" class="sidebar-link">安装依赖：@koa/router</a></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#定义路由" class="sidebar-link">定义路由</a></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#中间件" class="sidebar-link">中间件</a></li></ul></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#常见获取值的几种方式" class="sidebar-link">常见获取值的几种方式</a></li><li class="sidebar-sub-header"><a href="/font-end-nodes/basic/node/01-koa.html#创建-restful-接口" class="sidebar-link">创建 RESTful 接口</a></li></ul></li><li><a href="/font-end-nodes/basic/node/02-webpack5构建.html" class="sidebar-link">webpack5构建加持</a></li><li><a href="/font-end-nodes/basic/node/03-项目规范及工具.html" class="sidebar-link">项目规范及工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/ts/" class="sidebar-link">概念</a></li><li><a href="/font-end-nodes/basic/ts/01-环境配置.html" class="sidebar-link">环境配置</a></li><li><a href="/font-end-nodes/basic/ts/02-基础语法.html" class="sidebar-link">基础用法</a></li><li><a href="/font-end-nodes/basic/ts/03-内置方法.html" class="sidebar-link">TypeScript 内置方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>mongoDB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/mongo/" class="sidebar-link">认识 MongoDB</a></li><li><a href="/font-end-nodes/basic/mongo/01-创建用户并分配权限.html" class="sidebar-link">创建用户并分配权限</a></li><li><a href="/font-end-nodes/basic/mongo/01.1连接MongoDB.html" class="sidebar-link">MongoDB交互终端</a></li><li><a href="/font-end-nodes/basic/mongo/02-基础操作.html" class="sidebar-link">基本操作</a></li><li><a href="/font-end-nodes/basic/mongo/03-高级查询.html" class="sidebar-link">高级查询</a></li><li><a href="/font-end-nodes/basic/mongo/04-复制集.html" class="sidebar-link">复制集</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webthree</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/font-end-nodes/basic/webthree/" class="sidebar-link">webThree</a></li><li><a href="/font-end-nodes/basic/webthree/01.defi.html" class="sidebar-link">Defi</a></li><li><a href="/font-end-nodes/basic/webthree/02.基础.html" class="sidebar-link">基础</a></li><li><a href="/font-end-nodes/basic/webthree/03.公链区块链特性.html" class="sidebar-link">公链</a></li><li><a href="/font-end-nodes/basic/webthree/04.btc.html" class="sidebar-link">bth</a></li><li><a href="/font-end-nodes/basic/webthree/05.前端架构.html" class="sidebar-link">前端架构</a></li><li><a href="/font-end-nodes/basic/webthree/06.前端技术选型.html" class="sidebar-link">前端技术选型</a></li><li><a href="/font-end-nodes/basic/webthree/07.简历素材.html" class="sidebar-link">简历素材</a></li><li><a href="/font-end-nodes/basic/webthree/08.项目.html" class="sidebar-link">项目 Monorepo 项目</a></li><li><a href="/font-end-nodes/basic/webthree/09.构建工具关系分析.html" class="sidebar-link">前端构建工具与包管理工具关系分析</a></li><li><a href="/font-end-nodes/basic/webthree/10.tailwind配置.html" class="sidebar-link">Tailwind CSS 配置指南</a></li><li><a href="/font-end-nodes/basic/webthree/11.useImmer.html" class="sidebar-link">解决状态撕裂</a></li><li><a href="/font-end-nodes/basic/webthree/12.MUI主题系统完整指南.html" class="sidebar-link">MUI (Material-UI) 主题系统完整指南</a></li><li><a href="/font-end-nodes/basic/webthree/13.react-router-guide.html" class="sidebar-link">React Router v6 配置完整指南</a></li><li><a href="/font-end-nodes/basic/webthree/14.helmet-complete-guide.html" class="sidebar-link">React Helmet 完整指南</a></li><li><a href="/font-end-nodes/basic/webthree/15.webpack优化.html" class="sidebar-link">webpack优化</a></li><li><a href="/font-end-nodes/basic/webthree/16.配置eslint.html" class="sidebar-link">配置Eslint</a></li><li><a href="/font-end-nodes/basic/webthree/17.前端架构.html" class="sidebar-link">前端架构（10）</a></li><li><a href="/font-end-nodes/basic/webthree/18.ServerLess.html" class="sidebar-link">11月23日</a></li><li><a href="/font-end-nodes/basic/webthree/19.以太坊.html" class="sidebar-link">Ethereum</a></li><li><a href="/font-end-nodes/basic/webthree/20.hardat.html" class="sidebar-link">hardhat</a></li><li><a href="/font-end-nodes/basic/webthree/eslint-prettier-setup.html" class="sidebar-link">ESLint 和 Prettier 配置指南</a></li><li><a href="/font-end-nodes/basic/webthree/ioc-nestjs-nextjs-guide.html" class="sidebar-link">IoC 原理、Nest.js CRUD 应用和 Next.js 应用搭建指南</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="koa-下一代web框架"><a href="#koa-下一代web框架" class="header-anchor">#</a> koa(下一代web框架)</h1> <p><a href="https://koajs.com/" target="_blank" rel="noopener noreferrer">koa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (<a href="https://www.koajs.com.cn/" target="_blank" rel="noopener noreferrer">中文网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)是基于 Node.js 平台的下一代 web 开发框架，致力于成为应用和 API 开发领域中的一个更小、更富有表现力、更健壮的基石；利用<em>async 函数</em>丢弃回调函数，并增强错误处理，koa 没有任何预置的中间件，可快速的编写服务端应用程序。</p> <h2 id="核心概念"><a href="#核心概念" class="header-anchor">#</a> 核心概念</h2> <ul><li>Koa Application（应用程序）</li> <li>Context（上下文）</li> <li>Request（请求）、Response(响应)</li></ul> <h2 id="初识-koa"><a href="#初识-koa" class="header-anchor">#</a> 初识 koa</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>// 创建一个 acquaintance 的文件夹
$ <span class="token function">mkdir</span> acquaintance

// 进入创建的文件夹
$ <span class="token builtin class-name">cd</span> acquaintance

// 初始化 package.json
$ <span class="token function">npm</span> init <span class="token parameter variable">-y</span>

// 安装 koa，安装完之后
$ <span class="token function">npm</span> i koa
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>可以在 package.json 中查看安装的所有依赖</p></div> <p>在工程目录里创建一个 app.js，代码如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span> <span class="token comment">// 引入koa</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 实例化koa</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'hi koa'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 启动应用程序  参数：端口号</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3003</span><span class="token punctuation">)</span>
</code></pre></div><p>在终端中使用<code>node app.js</code>命令（前提是终端中的路径必须指向所创建工程文件夹的路径）
打开浏览器访问：<code>http://localhost:3003</code> 此时浏览器中就会输出<code>hi koa</code>，如下图：</p> <img src="data:image/png;base64,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" style="display:block;box-shadow:2px 1px 1px #d0c6c629;"> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>上面代码虽然轻松实现了一个 web 服务器，但是返回的数据和所请求都是固定的；并不适应真实的业务场景，比如：获取请求接口时的参数、方法、修改一次代码就要在终端中重新运行启动命令等；</p></div> <p>由于使用的<code>node app.js</code>启动，所以每次更改都要重新启动，这样给我们开发带来了极大的不便利，所以我们可以使用一些第三方依赖来自动监听文件的变化并重新启动，开发环境可以使用<code>nodemon</code> 首先安装<code>npm i nodemon -D</code>，也可以全局安装此依赖，生产环境的话可以使用<code>pm2</code>
安装之后在<code>package.json</code>的<code>scripts</code>中添加启动方式；如下</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;acquaintance&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nodemon app.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;koa&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.13.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;nodemon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.7&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在终端中执行命令：<code>npm run dev</code>,这样就不用我们每次修改都重新启动，执行之后就会在终端中提示，如下：
<img src="/font-end-nodes/assets/img/e59f418482657d4dd68a3543880292b.36cc8278.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>执行命令时，终端的路径必须指向当前程序</p></div> <h2 id="路由-中间件"><a href="#路由-中间件" class="header-anchor">#</a> 路由&amp;中间件</h2> <h3 id="安装依赖-koa-router"><a href="#安装依赖-koa-router" class="header-anchor">#</a> 安装依赖：<a href="https://www.npmjs.com/package/@koa/router" target="_blank" rel="noopener noreferrer">@koa/router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <div class="language-git extra-class"><pre class="language-git"><code>$ npm i @koa/router
</code></pre></div><h3 id="定义路由"><a href="#定义路由" class="header-anchor">#</a> 定义路由</h3> <ul><li>在 app.js 中引入<code>@koa/router</code>，然后再实例化</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@koa/router'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 实例化的时候可以自定义一个接口前缀</span>
</code></pre></div><ul><li>注册 router</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>定义接口</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'hi @koa/router'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">nickname</span><span class="token operator">:</span> <span class="token string">'Forest'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      <span class="token literal-property property">jobs</span><span class="token operator">:</span> <span class="token string">'前端攻城狮'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">skills</span><span class="token operator">:</span> <span class="token string">'搬砖'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>完整代码如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@koa/router'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 添加接口前缀</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'hi @koa/router'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">nickname</span><span class="token operator">:</span> <span class="token string">'Forest'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      <span class="token literal-property property">jobs</span><span class="token operator">:</span> <span class="token string">'前端攻城狮'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">skills</span><span class="token operator">:</span> <span class="token string">'搬砖'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 启动应用程序  参数：端口号</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3003</span><span class="token punctuation">)</span>
</code></pre></div><p>在浏览器中请求：<code>http://localhost:3003/api/v1</code>、<code>http://localhost:3003/api/v1/user</code>，结果如下图：<br> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZwAAACiCAYAAAB1RntQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABhcSURBVHhe7Z17jB3Vfce3f/ev/ldVlRpUWqkPRWraP6K0jdrGrd2XcENFEqSUChQCxihJCw3dJk0MqIQ3mOLF4ZWYNTgO1CTeUtaG8krB+LW7lIeNsb3rfdgGS61KAan/nM7vzD0zZ86cmTtzH+fO3fv5SB/dmXPOzL0zc+Z898zetce2bXtEISIi9tuxc+fOKURExH479t577ylERMR+S+AgImIQCRxERAwigbMKPXXqlDpy5KianZ1Thw4dVvv3H1CvvrofEXGgEjirxHfffVcdP35cHTx4yHuhEREHLYGzCjx5cl7PZHwXGBGxKRI4Q+78/Lz3wiIiNk0CZ4idn1/wXlRExCZK4Aypy8sr3guKiNhUCZwhdWZmxntBERGbas8DR76S+/ff+LbWVx/CPc88q/bsfVatrKx46/uhHPf2x3bq477ksiu0svzAQ9/XdabdPVu2ZrbrRPk2mu9ilvnCCy+q226/Q13+5SvVBesv1MqylEmdbxtExF46Jl+n7ZULCwvJgHvdP3zL2yaE03ufUf/y5I/V9J5n1PLysrdNL/3Xf5tWV1z11SRoXKVO2my+9z697ttHVc+cOasOHDjovZhFfvf+B9XnPn+xDplrrr1O3XrbHVpZljKpkza+bRERe2XPAscNG1n3tQuhhEyo0JEgMcEigSJ/bGnqZNmEjK29fV1PnDjhvZBFSpBIqHzp8ivU9PSeXL2USZ202fbIZK6+2D3q5vXnqysnfXW9c/qWz6qPbdger09uVB9bf6uadtr038fVpuj8rDdu2Op8hr1qYkNav2Fir1UXufOGdNv1N6idVt30xNVW3YVq005rO9vprWpD7n3rq9/Pux85hqvVxLRbXqSck+yxILazJ4HTpLAxhggdOU4zs5Hg8bURN934nZ4FzhtvvOm9kD7lUZnMXiRQ7HIJF9EukzbStvrjtdUVOJMbzlcX3JIPZG0UGGkQxOFih8rOTVFYbHq8tR6HU9JegmJ9OpBnB/xoX5uswV8Hk38Ql/fIBVkvlfeuGGhpSBI4WM+uA6eJYWPsd+hMPvoDfdwyi/HVi72e4czNvea9kD7lsZkEizuz8QWOtJEy2cYuL3aEAsdRD7iZgMnODOz6bFt/+/Z1/Z9NSKAVzq4sk8DUQUrgYD27Cpwmh42xn6EjxyzHbj9Gs/WFjehrW9U6/3SNzFrk9zS+Op/SVr5I4KvL6wkcCYTzzk81QWGcvlVdYNUnA7yznT3w+wJnUspMe/c92nwGCZakTodXfBzpNp9VN0cDfnbWYuuEgm9mkAzG8WzIHciLZiv5cGop72GX65lQ+hjO3pfZh341bdxtczMZK9B89aXHaJUhtrGrwDEDbh0loHz76kQTJHWU0PHtqxPNMfnq+qXvIhZZNGPxzXBEMyNyy/06gaMH+niwtuuT8NBhY9dvVze36iY3bFSTuixS7yddzwVOFArZfdb4DFJvzZCmJ7cny+4Mxw0cvS6DtzvIlg7GFQJHt4337X9klt/Hzk3WZ9Dhk66boEn35TwC9HzebNC5syz/MRA42InBA0e28e2rEzsKnGgb37460RyTr65f+i5ikSEDx/tIyhrgqz+y2q6utEKj3SM1e7/tPkMcSFa4WVb/fDIglw/gXc1w3EFc9uXuP2M2ILLh0dL+jLnPK58x+xgvH4ieYCFwsAO7fqRmQkdmLo19pBbNakzYhHykZivn5tY77ta/9/HVV7UXj9SKAkfaul8wKNYOHGe2Y9QzEBngC+oz7fKPtaSueuC0+wytdR062fcQqwdOpD3YFgWOLisOnNyMwaqzw0gCJBdO+v3NjEtsEzjJ54mW3c9r13nKvO9v2hA4WNOefGmgqaHTz7ARq3xpwGh+n1OlbZkzM7PeC+nTzFhCfGnAO2DLYN9uhuMGQq9nONZnyJVb79Nx4HgGXnvQz89m3EdWWbPtPW1z79fdDCf/+UQz68nPfhIJHOzAsbNnz6pulX+x2A4dWfe1C+nS0pJ6Orphntj1I/X0nr163deuG+U4v3zVV/RxTz31tLeNKHXSRnzrrSPeNlV98816X4u+6HMX574I4AscmdlI246/Fq1nDvasIa5PBvFcfet3OG6IOO3qBE67zzB9y8bM+9vB5gaODMRpaNgDazxrsQd1u6155JbMYPTA7ASCGfCjuk32YC9hYAeMrJeFh1l3958JKefzZLaXOn9o6JlNdNyFj/MIHOzAngSO2KTQCRE2RjtM7rl3q56BmLqXX9mny0x9WShVVc6r70IWaf7wU0LHnemIUmb+uZuu//BTD/jpo7HcjMGpj7eN95OUb9jY8QwnaWO9R1ld5rPrGY+Ux+9th0g8iMujq5ZuCJgQatXnHpfpUGjVZwbwOAySukxQxJ8h/+gt+17ro1DIz3C2ZtpkZjB24Mhy7lha6kApfvRH4GAn9ixwRDd0fG1CKCETImyM//7c88lMx6fU9SJsjHUeq4kSOjJ7kVC59u+u0/9+mijLUiZ19cIG+26HA3ocOAUhkjEOrsJAQeyDPQ0c0YSO6KsPoQRNqLAxynE/sn1HErgSMvIvDEhZr2d7J0+e9F7MMuVRmfx+Rh6dSciIsixl1R+jYSj1I63c71baWzlwJNCKHpch9smeBw6Gse4sB0fD6jMcxPASOEPq4uKi94IiIjZVAmeIrfsvRyMiDlICZ8g9eXJe7d9/wHtxERGbJIGzCpTHa4cP819OI2KzHTtz5ozC4ff06dPq2LF3av3TN4iIISVwVqHz8wv6XzSQf+Pt0KHDPHJDxEZI4CAiYhAJHEREDCKBg4iIQSRwEBExiAQOIiIGkcBBRMQgEjiIiBjEMfmDQURExH5L4CAiYhAJHEREDCKBg1jiysqKtxwR69tV4Hz4yU8k1i3ryKlxNTY+5a/D1Wd0vddNzKXrcxNq3di4mipa75NvLy2oxZXlZJ0Qwl54bt8fV/K//nOjd/thdLgC5/SUGh9bpybmfHWn1dzEOjU2NtbG3g9QZx94SJ0775djP/6b6szhmbh88tFMubtddefUxLri407Nt5NzIoO2OTfJAC7h7ZybdRMT0fltLUf7MeXjU1F7GdxN2OuBPrttao3z6wZKzvR4psZ972W5bsKzfXdKsBxdXlA/u/8+deHcE7psmbAZuLovtPpiWb8o71uDV8JEnb6nrdLOt/0w2ujAqRYgaccyg2uyD3uQ1MoA1p+fiJNgiTSBc/rttzPl7jZlVj12bTTYzsl2ueP1nBNj1HZcyq3XZFsrCOSG1oETLWf2Je3N+7bUn9l5/zLtfRfqOab2QdW9y6fjYPnr13eri17bpX7r0Db12PHDuuzlI29k2lZX+l90vXLnKPpByjmXvbH8B7Rayg8onmtb2L9qKn2hzn4yfU36SHQfJD8w1eiDg5TAqen777+fWLesitKp2g5IlrnOnxus+hQ4c3NJqLz3qU+3L69ppYHZOjb7vMXnJJ25iOYcTY1H7aNzND4xpSbGZcBrDXx6QI/Ko3OXfW/n/Mkg1BoopV27G10PEtbnKDW3r9Zg7Wvb48F6pRU2zy0cUT//6lZ1amVJ3f/OfvXbrz2qvv/qS+pnbh9XEz95VrdZXk4ftbVXjiG6HtFxZK9nl4FTEAa9VcLLvXfi4+lJoHVoWZ/q9w8l3dq8wOn/9Wz0lwbsgTPWuTGdG63agNaHwHnu+SRY3t34laT8zJ69aeBceFF2m6rmZhK+Gz8yOhfxuYrqW0FRdsz+cxUNpBOx6ySEonAZLw27NATq3txVQtQcQ7xveS/ftetysPZoHpt9ZmaH+sZbcbAsRWV/tu8x9Uu3fFPd9eJe9cn7blFvnjxR8/c5rRt6ynNNGx84nmuW65vhlX5s+p69LOeEwKlrgMCRG6ZTf+PBixNN2S/c+r+Jpuy/t40lmrIqzm5Zq8Z379YD7G5dNqu2rF2rtsza9dn2a7fMJusrs1vU2vHd6bre3uyrd56e3pMEy9k7NyflZ6zf4Zy98Z8y21RTPm90k1vHuLJin4/U3UnAOHW7ZTCyz4FttK/ofK6Ntsuct2gbsy77Hd8dfw7Z/9otu5PlsbHstYjLIgvfr6V8JtPWY+Z4k8+Sfoaca7eoWXv/XShhI6/b3zmkfuXgQ2p+eVEtRbMYKfvmnVvVr/3lZXr5yl2TauOu7Xp5aWlJv7Y37b9yXtNzLtehdQzSZ+3jsdYz20i5XOvMuUyvR7LfpD/IclG7ijp9yb7f4n6Sts2uZ69dtj/Hpu3btE2ONz6uTL9zTM9vM60TOL7ti21dd6tvZM6jt88495e5zrqfmfJ0bKl1v1sOQeCsZDpvtmOmJ8Bub9ZDBc6ZXT9KguXc2j+Nfrp6SofQ2TvuSsrP7Njp3bbM+KLK57UHC1dr8JidzQ+8epCIZir2NnJOzIAVvY5HN6Z+L3Ouom28A4lVnirntMYA1urARYNBdqCKTN6z6NpZg3UPlMBZWllWHz/wsPrusX2tsmW179Cs+ovLv64uvvof1V33b1fHl0+pX998g/59jjxWE9195bXPlVxTa7lC4MTbyDlwzrm+xr6b3rSP+1L3A3C6P/e6u9cte5/a/cPeR2rSvvBYbNO+YB9X5hi9fbVZ9jdwWve5rMs5NX1Ilu3zb8YBve5cK7cvJtfGfw2r2OjA2T3eOnirEyadSk6G0zH1oGkPrF47O1Fl2o/Uijx96LB320J1R/B93qKL3epkXu0bXpSO5WsX7bf1vnKOzfnMB07R9rGZwMgYf/Ytba5TZvsq72nfFF0oQSOv3zn6ovrU4cm4bDmevVx+3U1q80M71FtHj6nf+8JV6tiRY+rGZ3arCyfvy7Qr17mh7RvYHIN7k/tu+uiYM4OpdX9ktfpKa7via5M9v0XtkmBwPldx4Pj6pdsfrfZW/7Prs8pnjY+r7J4v38fg7fsMx7Mu58u9tum18vRP97zqa97qK3a/rGhXgWN/GaBuWXvtg3dunOjmKj9xLaXzZm7EtKOmZd27PD+feXwmypcEkvVo1uPbrsw4bN2OI/rKzI3nOzarvb6ZrWU5N9GrzHDidZkJRfWmo0X1mXMaledvYqeTlmh+gJDPWjQY5K5h8p5F1y46vg46vk+Zycjf3Jy3/341deK1pHxq7wvqzy+7Rp04Oa/Xr7/7AfW1TXfo5U/ce5P68cz+pG257rmSdTle6xjkOtjH41uPrk3m/LXuiWQ9Md9X5Px2/EhNLLj/3OuWrvv7q6u7fdyfnb6QmPYFuy9l+pW3rzbLoQgcb79q2eqLpW0cuwqc/mrdhN4b1e3EnjI9iNonw7ddHzx6NBM4Z+5/0N+urb6btd0NLPX5mz/+CcXaznQWW3OurJs1MxDo8t1qSxQcuW1t2wSAGUyKzNwQyWeRa+dv36sZjrjh9afUBbOP6+XFaNYiv5+RR2nbdz2ly04tLqpjx0+oP/ziV9Ur+w6q7x14Sf3Bg3dm9lGs248jdaBE5zM5Brl+aRt9rjJ1cg2d/WQGBrvO31cyA3Nt48+31rmP9OdMPoPdB+Pr5ns/u2+5gaMtHPBkn/H728eil6MfmkzftPdt92d7OfeeAa0SOP8z91e63Xuz13j34de97ta6nNPcOGDWnX6l65z+mtPfx4rs+SO1/3tyLLGsrJ3ZDuyYC5JIOZHuwJNrl3bUtKx7z143Hv/eJlK+NNDt7CbVdzGLLnB8Y2dnOabMKtcDXHSezLmJXtMZTutcJYP8Svam1J3V7YBOJ61g2YCXHQTkWLODRz99eeGo+tUDD6nXF+Nvn4kPPLpLfenr+S98PBoF0Be/9m29vH5yQt330rO5Nnn950qO2e67uu+3jlsPoLouvpbJecsMHOY8yb7t90j7ir3PbgNaf97cvZleK/lc+tuNnutov799rZNlfVzpfor7eWTuM/iVfQ9r4Jg29WY56XX3rWf6gnM/J3XWWJC2Necuez3rnMPGBo65abInp8Do5Hg7jzWoJj+Rd3mz+UzCxVXCJprt+LapZtxR5ObNHbNtdEzb7ONPjtfqTFbH0Z3GPifG8S3JzTweDXRxedpRk9+ptdZjexA4mc/iez9nwPJZcfApc+3MD9Qfze1Ue06+rp48OaeeOHpI/f7nr1IT236onn3pFbXn+ZfVMy9Gry/8h3ruJ6+qz3xho5rYsUvd9tK0+sU7v+Xd52B1B57mWnnwN/d0tNx+bKjXL0Pbv8Bpro0NnGFS/tkaN2g6f4y2GvQFRPMHvuuPPKc+PbdD/e6h7ep3ZiIPPKIu3nSTuvRvrleX/K14g7okWb5eXXrNDeqCu29X6yb/WV36w+959zlQ5YeMHgRx/x2eYOylBE5NfV8GqFqGOAwurSyVfuVZvmhQ/e9wAumb4TbS9PFYZsY7IkqItPdP9Gu93+E01wZ/aQAxrBIevvIqVvs7HMTRdsz80RoiImI/JXAQETGIBA4iIgaRwEFExCASOIiIGEQCBxERg0jgICJiEAkcREQMIoGDiIhBJHAQETGIYw8//LBCRETst2MKAAAgAAQOAAAEgcABAIAgEDgAABAEAgcAAIJA4AAAQBAIHAAACAKBAwAAQSBwAAAgCAMOnBm1ec0atUa7OVoDAIDVSkMCh7ABAFjtEDgAABCE2oFz6tQpdfToUa9SVw8CBwBgVKgdOB988IE3bESpqweBAwAwKnT0SG1xcTEXNgsLC63aqhA2AACjREeB8+GHH+YCp/7sRiB0AABGhY6/NGDPcurPbgwEDgDAqNBx4NiznM5mNwKBAwAwKnQcOILMcjqf3QgEDgDAqNBV4Hz00UddzG4EEziEDgDAaqerwAEAAKgKgQMAAEEgcAAAIAgEDgAABGFggbN3797WEgAAjAIEDgAABIFHagAAEISRmOHI3/nYr8PIajgGABhtRmKGQ+DUYVHd/VMH1c8lvqkOtmpiuq0HgFFl1c9wuhmox8Y6Oz2dbldE+LAxIdHrdQAYZUZihtMpTQmccPQ6YNx1ABhlBjYyNuVbahIOtr4yU27jq7PLiuoM7rpgynx1ZfRv5kPgAEDvqD6qrUJ8A75N0aDfj+2q7iMcvrAgcACgcwY2qjVthuOj3aBvtnXbVd2fb71o27AUBQWBAwCd04TRrRH4Bvqywd+uc9sVbddpu7CUhQSBAwCdM7CRrQkznHYBYK8XLQudbCfLRXWCux6GbgOl3Xr8+6b+f9sOAJrIIEa1xmAGfaOPojp7O18bX5lgl/uW7bKq9G4ANwHhmgZGvo1dJ7SrD/H1bgBoIvVGth7SlN/hQFgIG4DRZWCBAwAAowUzHAAACAIzHAAACAIzHAAACAIzHAAACAIzHAAACAIzHAAACMJIzHDM336s1r8BCXl8P31t3GXM62pmWI9xlK4RDBcj0SMJnN7hG8xkucrg1skAaPZtv4e93C/6vf9+Yp8ngCYxsB4ZaoZD2PSOsoGsH4Nb2fv04/1s+r1/Q6/fJ9T5AegEeiX0hH4NnIIsuwNpr9/Ppp/7dgn5XgCDZmC9fdDfUnP/sUzfP5hZtc6tN2Xt6lw63a6MUDM7OwjcQdSUueVlmLZVXo02ReVCWZ1Qto27bDBldnnZulm2dSmqs8t89QBNZaR7qhm83VfBHdhD1pW1E9z1JuAOfL5BsM7AaNq2exXsZaFsvU5bF6nz1Zfto6xO8O1PqLJd0bYATWVgPbYJf4djBm73VZBlVxtfmaGsTjD1dpuiZcFub2wa7QZIoc4AadpWfbVxy4raGG18bQ1FdWX7aLf/sn262rjrAMPASPdaM3C7r0LVQb2sna+u7D1kvd02TaXKgFhnkLTbyrLR4CszuGVl6+3a2hTVdbP/qvt0aVcP0EQG1muHYYZjE7rOpmy7plBlIK07SJbtw65z25Wt16lzKaqvuk9ZrtPWpt06wDAwsr1WBm0zcNuv9mBu1u0ywS6vUye49XYbX5mhrK6MUF+XNrZbt8ur4NuuaN3GbWNj19ltzKsPX3ubKnXussFXJpjyova+OoAmM7De2oQZTpNwg6RusEB3MHAD9B/usgbR6SwGAGAYGNjIxgwHAGC04EdpAAAIAjMcAAAIAjMcAAAIAoEDAABBIHAAACAIAwicGbV5zRr9B4lr1myO1gAAYBQY0AzHhA6BAwAwKhA4AAAQBAIHAACCQOAAAEAQBhQ4AqEDADBKMMMBAIAgEDgAABAEAgcAAIJA4AAAQBAGEDgmbAgcAIBRYkAzHAAAGDUIHAAACAKBAwAAQSBwAAAgCAQOAAAEgcABAIAgEDgAABAEAgcAAIJA4AAAQBAIHAAACAKBAwAAQSBwAAAgCAQOAAAEgcABAIAgEDgAABAEAgcAAIJA4AAAQBAIHAAACIBS/w8H2HXUA118nAAAAABJRU5ErkJggg==" style="box-shadow:2px 1px 1px #d0c6c629;vertical-align:top;margin-top:10px;"> <img src="data:image/png;base64,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" style="box-shadow:2px 1px 1px #d0c6c629;vertical-align:top;margin-top:10px;"></p> <h3 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h3> <p>中间件其实就是一个个函数，通过<code>app.use()</code>注册；在 koa 中只会自动执行第一个中间件，后面的都需要我们自己调用，koa 在执行中间件的时候都会携带两个参数<code>context</code>(可简化为<code>ctx</code>)和<code>next</code>，<code>context</code>是 koa 的上下文对象，<code>next</code>就是下一个中间件函数;也就是洋葱模型；所谓洋葱模型，就是指每一个 Koa 中间件都是一层洋葱圈，它即可以掌管请求进入，也可以掌管响应返回。换句话说：外层的中间件可以影响内层的请求和响应阶段，内层的中间件只能影响外层的响应阶段。
<img src="/font-end-nodes/assets/img/85988383413dec71e0d17d991ac8a5a.c19f07d8.png" style="display:block;box-shadow:2px 1px 1px #d0c6c629;">
执行顺序按照 app.use()的顺序执行，中间件可以通过 await next()来执行下一个中间件，同时在最后一个中间件执行完成后，依然有恢复执行的能力。即，通过洋葱模型，await next()控制调用 “下游”中间件，直到 “下游”没有中间件且堆栈执行完毕，最终流回“上游”中间件。</p> <p>下面这段代码的结果就能很好的诠释，示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 1 end </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 2</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 2 end </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 3</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this is a middleware 3 end </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3004</span><span class="token punctuation">)</span>
</code></pre></div><p>运行结果：</p> <div class="language-text extra-class"><pre class="language-text"><code>this is a middleware 1
this is a middleware 2
this is a middleware 3
this is a middleware 3 end
this is a middleware 2 end
this is a middleware 1 end
</code></pre></div><h4 id="中间件是如何执行的"><a href="#中间件是如何执行的" class="header-anchor">#</a> 中间件是如何执行的？</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 通过 createServer 方法启动一个 Node.js 服务</span>
<span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Koa 框架通过 http 模块的 createServer 方法创建一个 Node.js 服务，并传入 <code>this.callback()</code> 方法， <code>this.callback()</code> 方法源码精简实现如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter">middleware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里返回的函数，就是上文中的 fnMiddleware</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> index<span class="token punctuation">)</span> <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'next() called multiple times'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      index <span class="token operator">=</span> i
      <span class="token comment">// 取出第 i 个中间件为 fn</span>
      <span class="token keyword">let</span> fn <span class="token operator">=</span> middleware<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> middleware<span class="token punctuation">.</span>length<span class="token punctuation">)</span> fn <span class="token operator">=</span> next

      <span class="token comment">// 已经取到了最后一个中间件，直接返回一个 Promise 实例，进行串联</span>
      <span class="token comment">// 这一步的意义是保证最后一个中间件调用 next 方法时，也不会报错</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fn<span class="token punctuation">)</span> <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token comment">// 把 ctx 和 next 方法传入到中间件 fn 中，并将执行结果使用 Promise.resolve 包装</span>
          <span class="token comment">// 这里可以发现，我们在一个中间件中调用的 next 方法，其实就是dispatch.bind(null, i + 1)，即调用下一个中间件</span>
          <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token function">dispatch</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 从 this.middleware 数组中，组合中间件</span>
  <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>middleware<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// handleRequest 方法作为 `http` 模块的 `createServer` 方法参数，</span>
  <span class="token comment">// 该方法通过 `createContext` 封装了 `http.createServer` 中的 `request` 和 `response`对象，并将这两个对象放到 ctx 中</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleRequest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将 ctx 和组合后的中间件函数 fn 传递给 this.handleRequest 方法</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> handleRequest<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> fnMiddleware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> ctx<span class="token punctuation">.</span>res<span class="token punctuation">;</span>
  res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> ctx<span class="token punctuation">.</span><span class="token function">onerror</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleResponse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">respond</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// on-finished npm 包提供的方法，该方法在一个 HTTP 请求 closes，finishes 或者 errors 时执行</span>
  <span class="token function">onFinished</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> onerror<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将 ctx 对象传递给中间件函数 fnMiddleware</span>
  <span class="token keyword">return</span> <span class="token function">fnMiddleware</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handleResponse<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>onerror<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将 Koa 一个中间件组合和执行流程梳理为以下步骤:</p> <ul><li>通过 compose 方法组合各种中间件，返回一个中间件组合函数 fnMiddleware</li> <li>请求过来时，会先调用 handleRequest 方法，该方法完成：</li> <li>调用 createContext 方法，对该次请求封装出一个 ctx 对象；</li> <li>接着调用 this.handleRequest(ctx, fnMiddleware)处理该次请求。</li> <li>通过 fnMiddleware(ctx).then(handleResponse).catch(onerror)执行中间件。</li></ul> <h2 id="常见获取值的几种方式"><a href="#常见获取值的几种方式" class="header-anchor">#</a> 常见获取值的几种方式</h2> <ul><li>在 params 中取值，<code>eg：http://localhost:3003/api/v1/user/1</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 前端请求</span>
<span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3003/api/v1/user/1'</span><span class="token punctuation">)</span>

<span class="token comment">// 服务端</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span><span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//获取url的id</span>
  cosnt <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>params<span class="token punctuation">;</span> <span class="token comment">// { id: 1 }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>在 query 中取值，也就是获取问号后面的。</li></ul> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code><span class="token comment">// 前端</span>
<span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3003/api/v1/user?name=Forest&amp;age=18'</span><span class="token punctuation">)</span>

<span class="token comment">// 服务端</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//获取url的id</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query <span class="token comment">// { name: Forest, age: 18 }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>获取 header 中的参数：</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//请求接口时设置请求头</span>
axios
  <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
    <span class="token string">'http://localhost/user?name=Forest&amp;age=18'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">Author</span><span class="token operator">:</span> <span class="token string">'token'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//......</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res:'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//在服务端获取则是：</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//获取 url 的 id</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> Author <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>header <span class="token comment">// { Author: 'token' }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>获取 body 中的数据，在服务端获取 body 中的一些数据只能用一些外部的插件；如：<code>koa-body</code>、<code>koa-bodyparser</code> 等等。
就以 <code>koa-body</code> 为例，首先安装 <code>npm i koa-body -S</code>，再引入：</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 服务端</span>
<span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'koa<span class="token operator">-</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//然后在注册中间件：</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//在服务端获取则是：</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span> <span class="token comment">// { name: 'Foreset', age: 18 }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//请求时有两种传参方式，一种是 json，另一种是 fromData；以 json 为例</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost/user'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Foreset'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res:'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="创建-restful-接口"><a href="#创建-restful-接口" class="header-anchor">#</a> 创建 RESTful 接口</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@koa/router'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-body'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'hi @koa/router'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">query</span><span class="token operator">:</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">,</span>
      <span class="token literal-property property">nickname</span><span class="token operator">:</span> <span class="token string">'Forest'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      <span class="token literal-property property">jobs</span><span class="token operator">:</span> <span class="token string">'前端攻城狮'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">skills</span><span class="token operator">:</span> <span class="token string">'搬砖'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>params
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      id<span class="token punctuation">,</span>
      <span class="token literal-property property">nickname</span><span class="token operator">:</span> <span class="token string">'Forest'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
      <span class="token literal-property property">jobs</span><span class="token operator">:</span> <span class="token string">'前端攻城狮'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">skills</span><span class="token operator">:</span> <span class="token string">'搬砖'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">,</span>
      age
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3003</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>koa-body 中间件的引入顺序必须在 router 之前，否则获取不了 post 请求携带的数据</p></div></div> <!----> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/font-end-nodes/basic/node/" class="prev router-link-active">
        内容介绍
      </a></span> <span class="next"><a href="/font-end-nodes/basic/node/02-webpack5构建.html">
        webpack5构建加持
      </a>
      →
    </span></p></div>  <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog" style="margin-top:15vh;width:420px;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button type="button" class="el-button el-button--default"><!----><!----><span>取 消</span></button> <button type="button" class="el-button el-button--primary"><!----><!----><span>确 定</span></button></span></div></div></div></main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/font-end-nodes/assets/js/app.832bd39e.js" defer></script><script src="/font-end-nodes/assets/js/2.a07749b4.js" defer></script><script src="/font-end-nodes/assets/js/1.80701c87.js" defer></script><script src="/font-end-nodes/assets/js/51.48a95f65.js" defer></script>
  </body>
</html>
